{% extends "../base.html" %}

{% block title %}
{{ site.name }}
{% end %}

{% block header %}
{% include '../home/header.html' %}
{% end %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{{ site_base }}/common/js/bodegas/dist/bodegas.client.css">
<link rel="stylesheet" type="text/css" href="{{ site_base }}/static/Swiper-3.4.2/dist/css/swiper.min.css">   
<link rel="stylesheet" href="{{ site_base }}/static/css/ocul.css">
<style type="text/css">


</style>
{% end %}

{% block javascript %}
<script type="text/javascript" src="{{ site_base }}/static/js/product_detail.js"></script>
<script type="text/javascript" src="{{ site_base }}/static/js/swiper.js"></script>
<script type="text/javascript" src="{{ site_base }}/static/Swiper-3.4.2/dist/js/swiper.min.js"></script>
<script type="text/javascript">

    $(document).ready(function()
    {

        $(document).on("click", ".main-1", function()
        {
            $(".img_prod_little").css("border", "none");
            $(this).children().css("border","solid 1px orange");

        });


            // $(document).on('click', '.tallas', function()
            // {
            //     $('.size-item').removeClass('active');
            //     $('.size-item').children().css("color", "rgb(91, 81, 83)");
            //     $('.size-item').css("background-color", "white");
            //     $(this).addClass('active');
            //     $(this).children().css("color", "white");
            //     $(this).css("background-color", "rgb(91, 81, 83)");
            // });

            // $(this).css("background-color", "rgb(91, 81, 83)");
            // $(this).parent(".num-tal").css("color", "white");

           var base_url = $.environmentVar(
        'https://apibodegas.loadingplay.com/',
        'https://apibodegas.loadingplay.com/',
        'https://apibodegas.loadingplay.com/');
         var checkout_url = $.environmentVar(
        'http://lpcheckout.ondev.today',
        'http://lpcheckout.ondev.today',
        'https://pay.loadingplay.com');
         var app_public = $.environmentVar(64,64,64);
         var site_name = $.environmentVar('lahorqueta', 'lahorqueta', 'lahorqueta');
        var variants_loaded = false;

        var options = {
            'app_public' : app_public,
            'base_url' : base_url,
            'checkout_url': checkout_url,
            'product_id' : {{ product_id }},
            'site_name': site_name,
            'variants': {
                'product_sku': '',
                'container': '.variants-container',
                'variant_template': '<div class="col-md-12 mover">{{! values }}</div>',
                'value_template': '\
                    <div \
                        class="col-md-4 col-sm-4 col-xs-4 size-item \
                            tallas variant-value" variant="{{! variant_name }}"\
                        value="{{! value }}" >\
                            <div class="num-tal">{{! value }}</div>\
                    </div>',
                'active_class': 'active'
            }, onLoad: function(product)
            {
                // check if variants were triggered
                if (variants_loaded)
                {
                    return;
                }
                // add some settings
                options.variants.product_sku = product.sku;

                // load variants
                $('.product-detail').ecommerce('load_variants', options);

                $('.variants-container').on(
                    'combination:selected', function(e, d)
                    {
                        $('.add-to-cart').attr('product-combination', d);
                        $('.add-to-cart').removeAttr('disabled');
                    });

                variants_loaded = true;  // execute this onces
                options.onLoad = $.noop;

                // inicialización del codigo de las imagenes

                related(product.bullet_3);
                related2(product.bullet_3);

                if (product.bullet_1 != "" ){
                    // $.get(site_base + "/article/tag?tag="+product.bullet_1, function(data)
                    // {
                    //     $("#article-reladed").html(data);
                    // });
                }

                var mainImage = $("#mainImage");
                    $(".img-container img").hover(function(){
                     var src = $(this).attr("src");
                     $("#mainImage").attr("src",src);
                 });

                mainImage.on("click",function(){
                    $(this).css("transform","scale(1.1)");
                });


                var main = $(".descuento-detalle").attr("main-price");
                var promotion = $(".descuento-detalle").attr("promotion-price");


                var promo = Utils.money(promotion);
                var original = Utils.money(main);

                if(promotion != 0){
                  var resta = Math.trunc((main - promotion)*100/main);
                  $(".descuento-detalle").removeClass("hidden");
                  $(".descuento-detalle").html("("+resta+"%)");

                  $(".precio-oferta").html(promo);
                }else{
                    $(".precio-oferta").html(original);
                    $(".descuento-detalle").addClass("hidden");
                    $(".product-price-2").addClass("hidden");
                    $(".oferta-de").css("color","#696e79");
                }

                var swiper = new Swiper('.swiper-container', {
                    pagination: '.swiper-pagination',
                    paginationClickable: true,
                    nextButton: '.swiper-button-next',
                    prevButton: '.swiper-button-prev',
                    spaceBetween: 30,
                });

                $(".carousel").on("touchstart", function(event){
                    var xClick = event.originalEvent.touches[0].pageX;
                    $(this).one("touchmove", function(event){
                        var xMove = event.originalEvent.touches[0].pageX;
                        if( Math.floor(xClick - xMove) > 5 ){
                            $(".carousel").carousel('next');
                        }
                        else if( Math.floor(xClick - xMove) < -5 ){
                            $(".carousel").carousel('prev');
                        }
                    });
                    $(".carousel").on("touchend", function(){
                        $(this).off("touchmove");
                    });
                });
            }
        };
        $('.product-detail').ecommerce('product_detail', options);

        // productos relacionados
        var related = function(tag)
        {
            var config = {
                'app_public' : app_public,
                'base_url' : base_url,
                'maxProducts' : 8,
                'templateOrigin' : '#product_template_home',
                'tag' : '',
                'ignore_stock' : true,
                'onLoad':function(){
                    // $('.ellipsis').ellipsis();
                    // $(".ellipsis").dotdotdot();
                 }
            };
            $('.product-related').ecommerce('product_box', config);
        };

        var related2 = function(tag)
        {
            var config = {
                'app_public' : app_public,
                'base_url' : base_url,
                'maxProducts' : 8,
                'templateOrigin' : '#product_template_home2',
                'tag' : '',
                'ignore_stock' : true,
                'onLoad':function(){
                    // $('.ellipsis').ellipsis();
                    // $(".ellipsis").dotdotdot();

                 }
            };
            $('.product-related2').ecommerce('product_box', config);
        };

    });

</script>


<script type="text/template" id="product_detail">
 
    <div class="container min">
        <div class="container">
           <section class="fer">
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <div id="myCarousel" class="carousel slide" data-ride="carousel">
                    <!-- Indicators -->


                    <!-- Wrapper for slides -->
                    <div class="carousel-inner" role="listbox">
                    <div class="item active">
                    <img class="{{! images[1]['thumb_500']|hide_if_empty}} little img_prod_little" src="{{! images[1]['thumb_500'] }}" onload="this.src={{! images[1]['thumb_500']}}" alt="Chania"  width="460" height="345">
                    </div>

                    <div class="item">
                    <img class="{{! images[2]['thumb_500']|hide_if_empty }} little img_prod_little" src="{{! images[2]['thumb_500'] }}"  alt="Chania" onload="this.src={{! images[2]['thumb_500']}}" width="460" height="345">
                    </div>

                    <div class="item">
                    <img class="{{! images[3]['thumb_500']|hide_if_empty }} little img_prod_little" src="{{! images[3]['thumb_500'] }}" alt="Chania" onload="this.src={{! images[3]['thumb_500']}}"  width="460" height="345">
                    </div>

                    <div class="item">
                    <img class="{{! images[4]['thumb_500']|hide_if_empty }} little img_prod_little" src="{{! images[4]['thumb_500'] }}" alt="Chania" onload="this.src={{! images[4]['thumb_500']}}"  width="460" height="345">
                    </div>

                    <div class="item">
                    <img class="{{! images[5]['thumb_500']|hide_if_empty }} little img_prod_little" src="{{! images[5]['thumb_500'] }}" alt="Chania" onload="this.src={{! images[5]['thumb_500']}}"  width="460" height="345">
                    </div>
                    <div class="item">
                    <img class="{{! images[6]['thumb_500']|hide_if_empty }} little img_prod_little" src="{{! images[6]['thumb_500'] }}" alt="Chania" onload="this.src={{! images[6]['thumb_500']}}"  width="460" height="345">
                    </div>
                    </div>
                    </div>
                    <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                    <span class="sr-only">Previous</span>
                    </a>
                    </div>

                    <div id="product-detail-id" class="col-md-6 col-sm-12 col-xs-12">
                        <div align="center">
                            <h1 class="name-detail" class="line" href="#">{{! name }}</h1>
                            <div align="center">
                            <div class="col-md-12 col-sm-12 col-xs-12 prin">
                                <div class="col-md-2 col-sm-2 col-xs-12">
                                <div class="product-price original-de">{{! main_price|money }} </div>
                                </div>
                                <div class="col-md-2 col-sm-2 col-xs-12">
                                <div class="product-price oferta-de hidden"> {{! promotion_price|money }} </div>
                            </div>
                            </div>
                            <div class="item__addtocart">
                              <input type="text" value="1" name="quantity" class="prod">

                              <button type="button" class="btn add-to-cart btn btn--primary vpe" id="open-cart" data-toggle="modal" data-target="#myModal" product-upp="{{! upp }}" product-name="{{! name }}" product-price="{{! main_price }}" product-sku="{{! sku }}" product-id="{{! id }}" product-img="{{! images[1]['thumb_500'] }}" lp-cart-add>Comprar</button>

                            </div>
                            <div class="texto-de">Descripción</div>
                            <h3 class="descr_prod_detail ellipsis multiline">{{! description }}</h3>
                            <div class="texto-de">Información</div>
                            <div class="texto-bu">{{! bullet_1 }}</div>
                            <div class="col-md-12 col-sm-12 col-xs-12">
                             <hr>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xs-12">
                             <img class="redes-detalle" src="https://84static.loadingplay.com/static/images/5aad0cec1a4d63e1677c11cdb366e87d_facebook_.png">
                             <img class="redes-detalle" src="https://84static.loadingplay.com/static/images/5aad0cec1a4d63e1677c11cdb366e87d_facebook_.png">
                             <img class="redes-detalle" src="https://84static.loadingplay.com/static/images/5aad0cec1a4d63e1677c11cdb366e87d_facebook_.png">
                             <img class="redes-detalle" src="https://84static.loadingplay.com/static/images/5aad0cec1a4d63e1677c11cdb366e87d_facebook_.png">
                            </div>
                        </div>
                            

                     </div>
            </section>
            </div>
            </div>

</script>


<!--
{% end %} -->



{% block body %}


<div class="container min">
    <div class="container min product-page"></div>
    </div>
</div>


<div class="product-detail sun"></div>

<!-- ***productos relacionados** -->
<!-- <hr class="detail">
<div class="container dano">
    <div class="row">
        <div class="col-md-12">
            <h1 class="text-relac text-center"><strong class="editabletext">Productos relacionados</strong></h1>
            <hr class="lin">
        </div>
    </div>
    <div class="row product-related">
    </div>
</div> -->

<section>
<div class="container min">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <h1 class="text-relac text-center"><strong class="editabletext"></strong></h1>
        </div>
    
    <div class="product-related">

    </div>
</div>
</section>






{% include '../home/footer.html' %}
{% end %}
